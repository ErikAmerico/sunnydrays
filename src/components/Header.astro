---
import { SITE } from "../config/site";

const links = [
  { href: "/", label: "Home" },
  { href: "/about", label: "About" },
  { href: "/services", label: "Services" },
  { href: "/intake", label: "Book Cleaning" },
  { href: "/contact", label: "Contact" },
];

const pathname = Astro.url.pathname;

function isActive(href: string) {
  return href === "/" ? pathname === "/" : pathname.startsWith(href);
}
---

<header
  class="sticky top-0 z-40 border-b border-b-[#d93a1b] bg-white/75 backdrop-blur"
>
  <div class="mx-auto flex h-16 max-w-6xl items-center justify-between px-5">
    <a
      class="flex items-center gap-2 font-semibold tracking-tight"
      href="/"
      aria-label="Go to homepage"
    >
      <img src="/assets/logo.png" alt="" width="34" height="34" class="block" />
      <span>{SITE.name}</span>
    </a>

    <nav class="hidden items-center gap-6 md:flex" aria-label="Primary">
      {
        links.map((l) => (
          <a
            href={l.href}
            data-astro-reload={l.href === "/intake" ? true : undefined}
            class={`text-sm font-medium transition-colors duration-500 ease-in-out hover:opacity-80 ${
              isActive(l.href) ? "text-[#d93a1b]" : "text-slate-600"
            }`}
          >
            {l.label}
          </a>
        ))
      }
    </nav>

    <div class="flex items-center gap-3">
      <a
        href="/intake"
        data-astro-reload="true"
        class="hidden rounded-xl bg-[#d93a1b] px-4 py-2 text-sm font-semibold text-white shadow-sm transition hover:bg-[#F29710] md:inline-flex"
      >
        Get Started
      </a>

      <details class="relative md:hidden group">
        <summary
          class="cursor-pointer list-none rounded-xl p-2"
          aria-label="Open menu"
        >
          <span class="sr-only">Open menu</span>
          <div class="grid gap-1.5">
            <span
              class="block h-0.5 w-6 rounded-full bg-slate-700 transition-all group-open:translate-y-2 group-open:rotate-45"
            ></span>
            <span
              class="block h-0.5 w-6 rounded-full bg-slate-700 transition-all group-open:opacity-0"
            ></span>
            <span
              class="block h-0.5 w-6 rounded-full bg-slate-700 transition-all group-open:-translate-y-2 group-open:-rotate-45"
            ></span>
          </div>
        </summary>

        <div
          class="absolute right-0 mt-2 w-64 overflow-hidden rounded-2xl border border-slate-200 bg-white shadow-xl"
        >
          <div class="grid gap-1 p-2">
            {
              links.map((l) => (
                <a
                  href={l.href}
                  data-astro-reload={l.href === "/intake" ? true : undefined}
                  class={`flex items-center rounded-xl px-3 py-2 text-sm font-medium transition hover:bg-slate-50 ${
                    isActive(l.href) ? "text-[#d93a1b]" : "text-slate-700"
                  }`}
                >
                  <span>{l.label}</span>
                </a>
              ))
            }

            <div class="my-1 h-px bg-slate-200"></div>
            <a
              class="rounded-xl bg-[#d93a1b] px-3 py-3 text-center text-sm font-semibold text-white shadow-sm transition hover:bg-[#F29710]"
              href="/intake"
              data-astro-reload="true"
            >
              Get Started
            </a>
          </div>
        </div>
      </details>
    </div>
  </div>
</header>
